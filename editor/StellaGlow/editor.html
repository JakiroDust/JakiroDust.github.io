<!DOCTYPE html>
<html>
<head>
  <title>BIN File Reader</title>

<script>
  var bin2Dict,data
</script>
  <script type="module">
    import {handleFileSelect } from "./bin2Dict.js";
    bin2Dict=handleFileSelect
  </script>
  <script>
    function readFile(input) {

      if (input.files && input.files[0]) 
      {
        var reader = new FileReader();
        reader.onload = function (e) {
          var data = bin2Dict(e.target.result);
        };
        reader.readAsBinaryString(input.files[0]);
      } 
    };

    function createTextbox(id,input="5%")
    {
      let cb= document.createElement("input");
      cb.style.width = input;
      cb.style.height = "60%";
      cb.id=id;
      cb.innerText="0"
      return cb;
    };
    function loadComboboxOptions(combobox, file) {
      var xhr = new XMLHttpRequest();
      var start_with=1;
      xhr.open("GET", file, true);
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
          var lines = xhr.responseText.split("\n");
          var firstLine = lines[0].trim();
          for (var i = 1; i < lines.length; i++) {
            if (lines[i].length > 0) {
              var option = document.createElement("option");
              if (firstLine === "1") {
                option.value = lines[i].substring(0, 2);
                start_with=3;
              } else if (firstLine === "2") {
                option.value = lines[i].substring(0, 4);
                start_with = 5;
              }
              option.text = lines[i].substring(start_with);
              if(option.value=='XXXX' || option.value=='XX')
              {
                option.disabled="true";
              }
              combobox.add(option);
            }
          }
        }
      };
      xhr.send();
    }
    
    function createCombobox(id,filepath="none",input="10%")
    {

     let cb= document.createElement("select");
     cb.style.width = input;
     cb.style.height = "10%";
     cb.id=id;
     if (filepath != "none")
     {
      loadComboboxOptions(cb,filepath)
     }
     return cb;
    };

    function createLabel(input_string="default")
    {
     let label= document.createElement("label");
     label.innerText=input_string;
     label.style.marginRight="1px";
     return label
    };

    function createInfobox(){
        // Create the main container
  var container = document.createElement("div");
  container.style.display = "flex";
  //container.style.flexDirection="column";
  container.style.alignItems = "center";
  container.style.justifyContent = "space-between";
  container.style.width = "30%";
  container.style.height = "100%";
  container.style.border = "1px solid black";
  container.id= "box"+0
  container.className="box"
  container.style.padding="10px"
  //Create Label
  var MoneyLabel=createLabel("Money")
  var NGlabel=createLabel("NG")
  var OrbChangeLabel=createLabel("Orb change when select wp")
  //Make obj
  var MoneyText=createTextbox("Money","20%")
  //
  var NGTickbox=document.createElement("input")
  NGTickbox.type="checkbox"
  NGTickbox.id="NG"
  //
  var OrbTickbox=document.createElement("input")
  OrbTickbox.type="checkbox"
  OrbTickbox.checked=true
  OrbTickbox.id="Orb"
  container.append(MoneyLabel)
  container.append(MoneyText)
  container.append(NGlabel)
  container.append(NGTickbox)
  container.append(OrbChangeLabel)
  container.append(OrbTickbox)
  document.body.appendChild(container);

    };

    function createBox(number)
    {
  // Create the main container
  var container = document.createElement("div");
  container.style.display = "flex";
  //container.style.flexDirection="column";
  container.style.alignItems = "center";
  container.style.justifyContent = "space-between";
  container.style.width = "98%";
  container.style.height = "100%";
  container.style.border = "1px solid black";
  container.id= "box"+number
  container.className="box"
  container.style.padding="10px"

  // Create the first combobox

  
  var StatusLabel=createLabel("Status")
  var LevelLabel=createLabel("Level")
  var ExpLabel=createLabel("Exp")
  var WeaponLabel=createLabel("Weapon")
  var ArmorLabel=createLabel("Armor")
  var AccLabel=createLabel("Acc")
  var OrbLabel=createLabel("orb")



  // Create the second combobox
  var StatusCombobox = createCombobox('StatusCombobox',"./resources/id/SG_Characters.txt")
  var ExpText=createTextbox('ExpText')
  var LevelText=createTextbox('LevelText',)
  var WeaponCombobox =createCombobox("WeaponCombobox","./resources/id/Weapons.txt")
  var ArmorCombobox = createCombobox("ArmorCombobox","./resources/id/Armor.txt")
  var AccCombobox=createCombobox("AccCombobox","./resources/id/Accessories.txt")
  var Orb1Combobox = createCombobox("Orb1Combobox","./resources/id/Orbs.txt","5%")
  var Orb2Combobox = createCombobox("Orb2Combobox","./resources/id/Orbs.txt","5%")
  var Orb3Combobox = createCombobox("Orb3Combobox","./resources/id/Orbs.txt","5%")
  var Orb4Combobox = createCombobox("Orb4Combobox","./resources/id/Orbs.txt","5%")
  var Orb5Combobox = createCombobox("Orb5Combobox","./resources/id/Orbs.txt","5%")
  // Append the comboboxes to the main container
  container.appendChild(StatusLabel);
  container.appendChild(StatusCombobox);
  container.appendChild(LevelLabel);
  container.appendChild(LevelText);
  //container.appendChild(ExpLabel)
 // container.appendChild(ExpText);
  container.appendChild(WeaponLabel);
  container.appendChild(WeaponCombobox);
  container.appendChild(ArmorLabel);
  container.appendChild(ArmorCombobox);
  container.appendChild(AccLabel);
  container.appendChild(AccCombobox);
  container.appendChild(OrbLabel);
  container.appendChild(Orb1Combobox);
  container.appendChild(Orb2Combobox);
  container.appendChild(Orb3Combobox);
  container.appendChild(Orb4Combobox);
  container.appendChild(Orb5Combobox);
  // Append the main container to the body
  document.body.appendChild(container);
  return container;
    }
  </script>
  <style>
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    .combobox {
      width: 150px;
      height: 30px;
      margin: 10px;
    }
    .textbox {
      width: 300px;
      height: 30px;
      margin: 10px;
    }
  </style>
</head>
<body>
  <input type="file" onchange="readFile(this)">
    <script>
    createInfobox();
    for (i =0;i<14;i++)
    {
      var temp =createBox(i)
    }
    
    </script>
</body>
</html>
